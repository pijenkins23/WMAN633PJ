P3 = fit3,
P4 = fit4,
P5 = fit5
)
mods <- aictab(cand.set = cand.set, second.ord = F)
df <- replace(mods$Modnames, 1:5, c('TL', 'TL +Sex' , 'Release Site' , "TL + Release Site", "TL + Release Site + Sex" ))
kable(mods)
df
mods[1:5,]
mods[,1]
# model selection AIC for Gamma
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
mods <- aictab(cand.set = cand.set, second.ord = F)
df <- replace(mods, mods[,1], c('TL', 'TL +Sex' , 'Release Site' , "TL + Release Site", "TL + Release Site + Sex" ))
kable(df)
df
# model selection AIC for Gamma
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
mods <- aictab(cand.set = cand.set, second.ord = F)
mods[,1] <-  c('TL', 'TL +Sex' , 'Release Site' , "TL + Release Site", "TL + Release Site + Sex" )
kable(df)
# model selection AIC for Gamma
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
mods <- aictab(cand.set = cand.set, second.ord = F)
mods[,1] <-  c('TL', 'TL +Sex' , 'Release Site' , "TL + Release Site", "TL + Release Site + Sex" )
kable(df)
# model selection AIC for Gamma
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
mods <- aictab(cand.set = cand.set, second.ord = F)
mods[,1] <-  c('TL', 'TL +Sex' , 'Release Site' , "TL + Release Site", "TL + Release Site + Sex" )
kable(mods)
mods
kable(mods, digits = 2)
kable(mods, digits = 2, row.names = NULL)
kable(mods, digits = 2, row.names = rownames(x))
kable(mods, digits = 2)
# model selection AIC for Gamma
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
mods <- aictab(cand.set = cand.set, second.ord = F)
mods[,1] <-  c('TL', 'TL +Sex' , 'Release Site' , "TL + Release Site", "TL + Release Site + Sex" )
mods %>%
rename(
Modnames = Model
)
# model selection AIC for Gamma
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
mods <- aictab(cand.set = cand.set, second.ord = F)
mods[,1] <-  c('TL', 'TL +Sex' , 'Release Site' , "TL + Release Site", "TL + Release Site + Sex" )
mods %>%
rename(
Model = Modnames
)
kable(mods, digits = 2)
# model selection AIC for Gamma
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
mods <- aictab(cand.set = cand.set, second.ord = F)
mods[,1] <-  c('TL', 'TL +Sex' , 'Release Site' , "TL + Release Site", "TL + Release Site + Sex" )
mods %>%
rename(
Model = Modnames
)
kable(mods, digits = 2)
mods
boxplot(MCP95~ Cap..Site, data=datc,par(mar = c(9, 5, 4, 2)+ 0.1), las = 2,
xlab="", ylab="MCP Home Range (ha)")
datc
unique(datc$Rel..Site)
datc$Cap..Site <-  c('Jacksonville', "Vandalia", "State Park" , "Little Skin Creek", "Mary Conrad Park", "Hog Hollow" )
boxplot(MCP95~ Rel..Site, data=datc,par(mar = c(9, 5, 4, 2)+ 0.1), las = 2, xlab="", ylab="MCP Home Range (ha)")
boxplot(MCP95~ Rel..Site, data=datc,par(mar = c(12, 5, 4, 2)+ 0.1), las = 2, xlab="", ylab="MCP Home Range (ha)")
datc[Rel..Site == "
little skin creek bridge "] = "Little Skin Creek Bridge "
datc[Rel..Site. == "
little skin creek bridge "] = "Little Skin Creek Bridge "
datc
datc[Rel..Site. == "little skin creek bridge "] = "Little Skin Creek Bridge"
datc$Rel..Site[datc$Rel..Site. == "little skin creek bridge "] = "Little Skin Creek Bridge"
boxplot(MCP95~ Rel..Site, data=datc,par(mar = c(12, 5, 4, 2)+ 0.1), las = 2, xlab="", ylab="MCP Home Range (ha)")
datc$Rel..Site[datc$Rel..Site == "little skin creek bridge "] = "Little Skin Creek Bridge"
boxplot(MCP95~ Rel..Site, data=datc,par(mar = c(12, 5, 4, 2)+ 0.1), las = 2, xlab="", ylab="MCP Home Range (ha)")
datc$Rel..Site[datc$Rel..Site == "little skin creek bridge"] = "Little Skin Creek Bridge"
boxplot(MCP95~ Rel..Site, data=datc,par(mar = c(12, 5, 4, 2)+ 0.1), las = 2, xlab="", ylab="MCP Home Range (ha)")
datc$Rel..Site == "little skin creek bridge"]
datc$Rel..Site == "little skin creek bridge"
datc$Rel..Site[datc$Rel..Site == "little skin creek bridge"]
knitr::opts_chunk$set(echo = TRUE)
library(equatiomatic)
library(adehabitatHR)
library("tidyverse")
#install.packages("AICcmodavg")
library(AICcmodavg)
library(multcomp)
library(knitr)
# install.packages("citr")
devtools::install_github("crsh/citr")
knitr::opts_chunk$set(echo = TRUE)
library(equatiomatic)
library(adehabitatHR)
library("tidyverse")
#install.packages("AICcmodavg")
library(AICcmodavg)
library(multcomp)
library(knitr)
# install.packages("citr")
devtools::install_github("crsh/citr")
knitr::opts_chunk$set(echo = TRUE)
library(equatiomatic)
library(adehabitatHR)
library("tidyverse")
#install.packages("AICcmodavg")
library(AICcmodavg)
library(multcomp)
library(knitr)
# install.packages("citr")
library(devtools)
install.packages("devtools")
knitr::opts_chunk$set(echo = TRUE)
library(equatiomatic)
library(adehabitatHR)
library("tidyverse")
#install.packages("AICcmodavg")
library(AICcmodavg)
library(multcomp)
library(knitr)
# install.packages("citr")
library(devtools)
install.packages("tidyverse")
install.packages(c("arkdb", "backports", "BH", "broom", "cachem", "clipr", "colorspace", "cpp11", "crayon", "DBI", "dbplyr", "deldir", "diffobj", "digest", "dplyr", "e1071", "fansi", "farver", "forcats", "furrr", "future", "generics", "globals", "hms", "htmltools", "isoband", "jtools", "knitr", "ks", "labeling", "lubridate", "lwgeom", "magrittr", "maptools", "mime", "parallelly", "pillar", "pkgload", "ps", "R6", "raster", "Rcpp", "readr", "reprex", "rfishbase", "rlang", "rmarkdown", "rprojroot", "RSQLite", "rvest", "sp", "tibble", "tidyr", "tinytex", "TMB", "tweenr", "units", "utf8", "vctrs", "xfun"))
install.packages(c("broom", "dbplyr", "deldir", "digest", "htmltools", "pkgload", "rfishbase", "rlang", "sp", "TMB", "vctrs", "xfun"))
install.packages("rlang")
remove.packages("rlang", lib="~/R/win-library/4.0")
install.packages("rlang")
install.packages(c("broom", "dbplyr", "pkgload", "rfishbase", "sp", "TMB"))
boxplot(MCP95~ Recaptured..summer.angling., data=datc, main="MCP",
xlab="Capture Site", ylab="Home Range MCP ha")
boxplot(MCP95~ Cap..Site, data=datc, main="MCP",
xlab="Capture Site", ylab="Home Range MCP ha")
boxplot(MCP95~ Rel..Site, data=datc,par(mar = c(12, 5, 4, 2)+ 0.1), las = 2, xlab="", ylab="MCP Home Range (ha)")
boxplot(MCP95~ Rel..Site, data=datc, las = 2, xlab="", ylab="MCP Home Range (ha)")
boxplot(MCP95~ Rel..Site, data=datc,
par(mar = c(12, 5, 4, 2)+ 0.1),
las = 2, xlab="", ylab="MCP Home Range (ha)",
cex = 2)
boxplot(MCP95~ Rel..Site, data=datc,
par(mar = c(12, 5, 4, 2)+ 0.1),
las = 2, xlab="", ylab="MCP Home Range (ha)",
cex = 2)
boxplot(MCP95~ Rel..Site, data=datc,
par(mar = c(12, 5, 4, 2)+ 0.1),
las = 2, xlab="", ylab="MCP Home Range (ha)",
cex = 8)
boxplot(MCP95~ Rel..Site, data=datc,
par(mar = c(12, 5, 4, 2)+ 0.1),
las = 2, xlab="", ylab="MCP Home Range (ha)",
cex.axis = 8)
boxplot(MCP95~ Rel..Site, data=datc,
par(mar = c(12, 5, 4, 2)+ 0.1),
las = 2, xlab="", ylab="MCP Home Range (ha)",
cex.axis = 2)
boxplot(MCP95~ Rel..Site, data=datc,
par(mar = c(12, 5, 4, 2)+ 0.1),
las = 2, xlab="", ylab="MCP Home Range (ha)",
cex.axis = 1.5,
cex.lab = 1.5)
boxplot(MCP95~ Rel..Site, data=datc,
par(mar = c(15, 5, 4, 2)+ 0.1),
las = 2, xlab="", ylab="MCP Home Range (ha)",
cex.axis = 1.5,
cex.lab = 1.5)
boxplot(MCP95~ Rel..Site, data=datc,
par(mar = c(15, 5, 4, 2)+ 0.1),
las = 2, xlab="", ylab="MCP Home Range (ha)",
cex.axis = 1.5,
cex.lab = 1.5)
library('sp')
library('sf')
#install.packages('adehabitatHR')
library(adehabitatHR)
#install.packages("rgdal")
library('rgdal')
library('maps')
library("tidyverse")
library(dplyr)
# loading data
dat <- read.csv("CompletedatawWQ.csv")
head(dat)
hr <- dat[c("Radio.Tag",'lat', 'lon')]
head(hr)
hr <- hr[!is.na(hr$lat) & !is.na(hr$lon),]
coordinates(hr) <- c('lat','lon')
str(hr)
head(hr)
# The sample data are lat long from WGS 84
proj4string(hr) <- CRS( "EPSG:4326" )
head(hr)
# converting to utm from lat lon
res <- spTransform(hr, CRS("+proj=utm +zone=17N ellps=WGS84"))
head(res)
kernel.ref <- kernelUD(res, h = "href" , grid=1000, extent= 5)  # href = the reference bandwidth
image(kernel.ref$`13`) # plot
kernel.ref[[1]]@h # The smoothing factor is stored for each animal in the "h" slot
#kernel.lscv <- kernelUD(hr, h = "LSCV") # Least square cross validation
#image(kernel.lscv) # plot
#plotLSCV(kernel.lscv) # Look for a dip
# hectares by default.
turtle.kernel.poly.95 <- getverticeshr(kernel.ref, percent = 95)
print(turtle.kernel.poly)  # returns the area of each polygon
turtle.kernel.poly.50 <- getverticeshr(kernel.ref, percent = 50)
print(turtle.kernel.poly)  # returns the area of each polygon
plot(turtle.kernel.poly.95 )
par(mfrow=c(1,1))
musky <- data.frame(
"Radio.Tag" = unique(dat$Radio.Tag))
head(musky)
# using MCP instead of KDE
# MCP
musky.mcp <- mcp(res, percent = 95)
#Calculate the MCP by including 50 to 100 percent of points
var.per <- seq(50, 100, by = 5)
hrs <- mcp.area(res, percent = var.per)
str(hrs)
musky$MCP95 <- musky.mcp$area
musky$MCP95ID <- musky.mcp$id
musky <- musky %>% select(1,3,4)
head(musky)
write.csv(musky, "MuskyHomeRange.csv")
tag <- read.csv('MuskyTaggingData.csv')
head(tag)
dat <- merge(tag,musky, by = "Radio.Tag")
datc <- dat[-c(3,36),]
datc
boxplot(MCP95~ Rel..Site, data=datc,
par(mar = c(15, 5, 4, 2)+ 0.1),
las = 2, xlab="", ylab="MCP Home Range (ha)",
cex.axis = 1.5,
cex.lab = 1.5)
library(tidyverse)
library(equatiomatic)
library(adehabitatHR)
library(dplyr)
#install.packages("AICcmodavg")
library(AICcmodavg)
library(multcomp)
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
# loading data
dat <- read.csv("CompletedatawWQ.csv")
hr <- dat[c("Radio.Tag",'lat', 'lon')]
hr <- hr[!is.na(hr$lat) & !is.na(hr$lon),]
coordinates(hr) <- c('lat','lon')
# The sample data are lat long from WGS 84
proj4string(hr) <- CRS( "EPSG:4326" )
# converting to utm from lat lon
res <- spTransform(hr, CRS("+proj=utm +zone=17N ellps=WGS84"))
musky <- data.frame(
"Radio.Tag" = unique(dat$Radio.Tag))
head(musky)
library(tidyverse)
library(equatiomatic)
library(adehabitatHR)
library(dplyr)
#install.packages("AICcmodavg")
library(AICcmodavg)
library(multcomp)
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
# loading data
dat <- read.csv("CompletedatawWQ.csv")
hr <- dat[c("Radio.Tag",'lat', 'lon')]
hr <- hr[!is.na(hr$lat) & !is.na(hr$lon),]
coordinates(hr) <- c('lat','lon')
# The sample data are lat long from WGS 84
proj4string(hr) <- CRS( "EPSG:4326" )
# converting to utm from lat lon
res <- spTransform(hr, CRS("+proj=utm +zone=17N ellps=WGS84"))
musky <- data.frame(
"Radio.Tag" = unique(dat$Radio.Tag))
head(musky)
# using MCP instead of KDE
# MCP
musky.mcp <- adehabitatHR::mcp(res, percent = 95)
musky$MCP95 <- musky.mcp$area
musky$MCP95ID <- musky.mcp$id
musky
tag <- read.csv('MuskyTaggingData.csv')
dat <- merge(tag,musky, by = "Radio.Tag")
datc <- dat[-c(3,36),]
datc$Rel..Site <- as.factor(datc$Rel..Site)
fit1 <- glm(MCP95 ~ TL..mm., data = datc , family= Gamma)
fit2 <- glm(MCP95 ~ TL..mm. + Sex, data = datc , family= Gamma)
fit3 <- glm(MCP95 ~ Rel..Site, data = datc , family= Gamma)
fit4 <- glm(MCP95 ~ TL..mm.+ Rel..Site, data = datc , family= Gamma)
fit5 <- glm(MCP95 ~ TL..mm.+ Rel..Site + Sex, data = datc , family= Gamma)
equatiomatic::extract_eq(fit1)
equatiomatic::extract_eq(fit2)
equatiomatic::extract_eq(fit3, wrap = TRUE)
equatiomatic::extract_eq(fit4, wrap = TRUE)
equatiomatic::extract_eq(fit5, wrap = TRUE)
# model selection AIC for Gamma
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
mods <- aictab(cand.set = cand.set, second.ord = F)
mods[,1] <-  c('TL', 'TL +Sex' , 'Release Site' , "TL + Release Site", "TL + Release Site + Sex" )
kable(mods, digits = 2)
fit4
fit2
summary(fit2)
View(mods)
View(mods)
# model selection AIC for Gamma
fit1 <- glm(MCP95 ~ TL..mm., data = datc , family= Gamma)
fit2 <- glm(MCP95 ~ Sex, data = datc , family= Gamma)
fit3 <- glm(MCP95 ~ Cap..Site, data = datc , family= Gamma)
fit4 <- glm(MCP95 ~ TL..mm.+ Cap..Site, data = datc , family= Gamma)
fit5 <- glm(MCP95 ~ TL..mm.+ Cap..Site + Sex, data = datc , family= Gamma)
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
#install.packages("AICcmodavg")
library(AICcmodavg)
mods <- aictab(cand.set = cand.set, second.ord = F)
head(mods)
fit1 <- glm(MCP95 ~ TL..mm., data = datc , family= Gamma)
fit2 <- glm(MCP95 ~ Sex, data = datc , family= Gamma)
fit3 <- glm(MCP95 ~ Rel..Site, data = datc , family= Gamma)
fit4 <- glm(MCP95 ~ TL..mm.+ Rel..Site, data = datc , family= Gamma)
fit5 <- glm(MCP95 ~ TL..mm.+ Rel..Site + Sex, data = datc , family= Gamma)
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
#install.packages("AICcmodavg")
library(AICcmodavg)
mods <- aictab(cand.set = cand.set, second.ord = F)
head(mods)
# trying to use kernel desnsity estimate of home range musky
# using https://jamesepaterson.github.io/jamespatersonblog/04_trackingworkshop_kernels#:~:text=Kernel%20density%20estimators%2C%20which%20map,each%20pixel%20within%20a%20grid.&text=The%20choice%20of%20kernel%20is,typically%20return%20very%20similar%20results.
# peter jenkins 2.24.2021
#install.packages('sp')
library('sp')
library('sf')
#install.packages('adehabitatHR')
library(adehabitatHR)
#install.packages("rgdal")
library('rgdal')
library('maps')
library("tidyverse")
library(dplyr)
# loading data
dat <- read.csv("CompletedatawWQ.csv")
head(dat)
hr <- dat[c("Radio.Tag",'lat', 'lon')]
head(hr)
hr <- hr[!is.na(hr$lat) & !is.na(hr$lon),]
coordinates(hr) <- c('lat','lon')
str(hr)
head(hr)
# The sample data are lat long from WGS 84
proj4string(hr) <- CRS( "EPSG:4326" )
head(hr)
# converting to utm from lat lon
res <- spTransform(hr, CRS("+proj=utm +zone=17N ellps=WGS84"))
head(res)
musky <- data.frame(
"Radio.Tag" = unique(dat$Radio.Tag))
head(musky)
# using MCP instead of KDE
# MCP
musky.mcp <- mcp(res, percent = 95)
# using MCP instead of KDE
# MCP
musky.mcp <- adehabitatHR::mcp(res, percent = 95)
#Calculate the MCP by including 50 to 100 percent of points
var.per <- seq(50, 100, by = 5)
hrs <- mcp.area(res, percent = var.per)
str(hrs)
musky$MCP95 <- musky.mcp$area
musky$MCP95ID <- musky.mcp$id
musky <- musky %>% select(1,3,4)
musky$MCP95 <- musky.mcp$area
musky$MCP95ID <- musky.mcp$id
head(musky)
write.csv(musky, "MuskyHomeRange.csv")
tag <- read.csv('MuskyTaggingData.csv')
head(tag)
dat <- merge(tag,musky, by = "Radio.Tag")
datc <- dat[-c(3,36),]
datc
boxplot(MCP95~ Rel..Site, data=datc,
par(mar = c(15, 5, 4, 2)+ 0.1),
las = 2, xlab="", ylab="MCP Home Range (ha)",
cex.axis = 1.5,
cex.lab = 1.5)
boxplot(MCP95~ Recaptured..summer.angling., data=datc, main="MCP",
xlab="Capture Site", ylab="Home Range MCP ha")
boxplot(MCP95~ Rel..Site, data=datc,
par(mar = c(15, 5, 4, 2)+ 0.1),
las = 2, xlab="", ylab="MCP Home Range (ha)",
cex.axis = 1.5,
cex.lab = 1.5)
boxplot(MCP95~ Recaptured..summer.angling., data=datc, main="MCP",
xlab="Capture Site", ylab="Home Range MCP ha")
# model to test if home range changes with sex, length or weight
fit <- glm(MCP95 ~ Sex + TL..mm. + Wt..kg., data = datc , family= Gamma)
summary(fit)
# model to check if home range size varies based on tagging location
fit <- glm(MCP95 ~ Cap..Site , data = datc , family= Gamma)
summary(fit)
fit1 <- glm(MCP95 ~ TL..mm., data = datc , family= Gamma)
fit2 <- glm(MCP95 ~ Sex, data = datc , family= Gamma)
fit3 <- glm(MCP95 ~ Rel..Site, data = datc , family= Gamma)
fit4 <- glm(MCP95 ~ TL..mm.+ Rel..Site, data = datc , family= Gamma)
fit5 <- glm(MCP95 ~ TL..mm.+ Rel..Site + Sex, data = datc , family= Gamma)
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
#install.packages("AICcmodavg")
library(AICcmodavg)
mods <- aictab(cand.set = cand.set, second.ord = F)
head(mods)
fit1 <- glm(MCP95 ~ TL..mm., data = datc , family= Gamma)
fit2 <- glm(MCP95 ~ TL..mm. + Sex, data = datc , family= Gamma)
fit3 <- glm(MCP95 ~ Rel..Site, data = datc , family= Gamma)
fit4 <- glm(MCP95 ~ TL..mm.+ Rel..Site, data = datc , family= Gamma)
fit5 <- glm(MCP95 ~ TL..mm.+ Rel..Site + Sex, data = datc , family= Gamma)
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
#install.packages("AICcmodavg")
library(AICcmodavg)
mods <- aictab(cand.set = cand.set, second.ord = F)
head(mods)
mods[,1] <-  c('TL', 'TL +Sex' , 'Release Site' , "TL + Release Site", "TL + Release Site + Sex" )
head(mods)
write.csv(mods,"G:\\My Drive\\QuantEcology\\HomeRangeProject\\AICtab.csv", row.names = FALSE)
fit1
fit1 <- lm(MCP95 ~ TL..mm., data = datc )
fit2 <- lm(MCP95 ~ Sex, data = datc )
fit3 <- lm(MCP95 ~ Cap..Site, data = datc )
fit4 <- lm(MCP95 ~ TL..mm.+ Cap..Site, data = datc )
fit5 <- lm(MCP95 ~ TL..mm.+ Cap..Site+ Sex, data = datc)
cand.set <- list(
P1 = fit1,
P2 = fit2,
P3 = fit3,
P4 = fit4,
P5 = fit5
)
mods <- aictab(cand.set = cand.set, second.ord = F)
head(mods)
